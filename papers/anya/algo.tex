bla bla bla

Essentially, the reason why the existing algorithms are not optimal
is that the search is based on the grid intersections.  
However, because the final any-angle path 
may never cross these intersections, 
the $A^*$ $f$ value associated with the intersections
is not relevant.  
In this article, we propose to run the search not on the grid 
but instead on the edges of the graph.  

% EOF
This section now presents our search algorithm, dubbed \anya, short for
any-angle pathfinding.  \anya{} is a variant of A* that does not search on the
space of intervals of the grid, but instead on the space of intervals and
corners.

\begin{algorithm}[ht!]
  \input{algo/anya}
  \caption{Procedure \anya, an any-angle pathfinding algorithm}
  \label{algo::anya}
\end{algorithm}

The general layout of \anya{} is given in Algorithm~\ref{algo::anya}.  
Like A*, \anya{} keeps a priority queue called $open$ 
and based on the $f$ value.  
The algorithm stops when the target is poped from the queue.  
Now, whether the current node is a corner or an interval 
is dealt with differently by \anya: 
\begin{itemize}
\item 
  For a corner, the successors of the corner are computed 
  (method successors\_of\_corner presented later) 
  and are added to the priority queue --- 
  the method add\_edge deals with computing the $f$ value 
  (presented later), updating if necessary the parent of a node, 
  and sorting the priority queue.  
\item 
  If the node is an interval, \anya{} moves it 
  and computes the corners of the new interval 
  (for this purpose, the target is seen as a corner).  
  Then, the interval is split according to the corners, 
  i.e., producing all the intervals between two consecutive corners.  
  All these corners and intervals 
  are potential successors of the current interval; 
  however, we need to check that they are visible from parent $p$.  
  To check whether an interval is visible, 
  we check whether its middle point is.  
\end{itemize}

We illustrate the computation of the successors 
of interval $i = \langle [1,2],3,p\langle$ 
where $p = \langle1,1\rangle$ 
(cf. Figure~\ref{fig::succ1}, right).  
The move of $i$ produces 
the interval $i' = \langle [1,2.5],4,p\rangle$.  
The set of corners of $i'$ is $\{\langle 2,4\rangle\}$.  
The split of $i'$ hence produces two intervals: 
$is = \{
\langle [1,2],4,p\rangle,  
\langle [2,2.5],4,p\rangle
\}$.  
The single corner is visible from $p$.  
The point $c' = \langle 1.5,4\rangle$ is also visible from $p$, 
which means that the first interval is visible from $p$.  
On the other hand, the point $\langle 2.25,4\rangle$ 
is not visible from $p$, 
which means that the second interval is not visible from $p$.  
The successors of $i$ are therefore $c'$ 
and $\langle [1,2],4,p\rangle$.  

\paragraph*{}

A corner $\langle x,y\rangle$ has potentially four successors.  
The first two obvious successors 
are the intervals at rows $y-1$ and $y+1$.  
However, the optimal path may follow a horizontal section, 
and the corner could have a successor on the left or on the right.  

\begin{algorithm}
  \input{algo/successorsofcorner}
  \caption{Computing the successors of a corner.}
  \label{algo::successorsofacorner}
\end{algorithm}

