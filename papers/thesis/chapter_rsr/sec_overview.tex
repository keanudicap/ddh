\section{Grid Symmetries}
Pathfinding in modern video games often involves exploring highly regular
environments such as cities, sewers or dungeons (e.g Figure
\ref{fig::rsr::bgmap}).  Though these locales tend to be topographically simple
(usually being comprised of empty rooms connected by corridors) they can also be
highly symmetric with many optimal length paths existing between arbitrary pairs
of locations.  Symmetry appears in many domains (e.g. constraint programming
\cite{walsh07}) and, unless it is handled properly, almost always increases the
size of the search space and forces search algorithms to waste time. In the case
of a uniform-cost grid map we define symmetry as follows:

\begin{definition}
\label{def::rsr::symmetry}
Two paths $\pi_{1}$ and $\pi_{2}$ are symmetric if they share the same start and
goal node and one can be derived from the other by interchanging the order of the
moves.
\end{definition}

Each node on a symmetric path to a node $n$ has an $f$-value smaller than or
or equal to $n$. During pathfinding search an algorithm such as A* can
often needlessly expand all symmetric predecessors of $n$ before expanding $n$ itself.
Such expansions are wasteful because the algorithm is not making any real progress
toward the goal. Rather, it is merely exploring different variations of all shortest 
paths to each expanded node $n$.

To address this problem we will use the following high level 
strategy to identify and eliminate many symmetric paths from the grid:

\begin{enumerate}
\item{Decompose the grid map into a set of empty rooms, where each empty room is
rectangular in shape and free of any obstacles.  The size of the rooms can vary
across a map, depending on the placement of the obstacles.}
\item{Prune all nodes from the interior but not the perimeter of each empty
room.}
\item{Add a series of \emph{macro edges} that connect each node on the perimeter
of an empty room with a set of nodes on the directly opposite side of the room.}
\item{When the start or goal is located in the interior of an empty rectangle, we use
a temporary node re-insertion procedure.  In a 4-connected map (shown here for
simplicity) we connect the temporary node, online, to the 4 nearest perimeter
nodes. A similar operation, involving sets of edges from each perimeter side, is
used when diagonal moves are allowed.}
\end{enumerate}

In Section~\ref{cha::rsr::4c} I will describe a simple implementation of this idea
in the context of 4-connected grid maps. Along the way I will show that the approach 
is complete and optimal and that the decomposed map requires only linear space to store.
In Section~\ref{cha::rsr::8c} I generalise the approach to 8-connected grid maps
where the increase in branching factor makes symmetry detection more difficult. 
I also introduce two enhancements that further improve the identification and elimination 
of path symmetries. In each case I will show that completeness, optimality and linear
space requirements are preserved. Finally, in Section~\ref{cha::rsr::experiments} I provide an empirical
evaluation of each idea on a range of realistic and synthetic benchmarks from the academic
AI literature. I find that rectangular symmetry reduction can improve the performance of A* 
search by a factor of between to 2 to 30 times, depending on the problem domain. 
I also compare RSR with Swamps~\cite{pochter08}, a recent state-of-the art pruning 
technique. I find that RSR and Swamps have complementary strengths and that they could be
easily combined.
