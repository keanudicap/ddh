\section{Principle Of Anya}
Consider as a motivating example the problem depicted in Figure~\ref{fig::ex1}.
We are tasked with finding an any-angle path between node $n_1 = (2, 0)$ and
node $n_2 = (3, 4)$.  The best online algorithm for solving this problem, to
date, is Theta*~\cite{nash07}. It operates by looking for a solution among the
set of discrete points that comprise the locations of the grid; i.e.,
it successively expands nodes $(2,1)$ to $(2,4)$ and $(3,0)$ to $(3,3)$ until
eventually $n_2$ is reached.  Notice however that the actual shortest path
between $n_1$ and $n_2$ may not pass through any of these discrete points.  To
account for this fact Theta* ``pulls the string'' each time a new
point is reached.  Thus when node $n_2$ is generated its $g$-value is not
computed as the length of the grid-constrained path used to reach it but rather
using the direct path $\langle n_1, n_2 \rangle$.

\begin{figure}[tb]
  \begin{center}
    \input{tikz/ex1}
  \end{center}
  \caption{Example of an any-angle path}
  \label{fig::ex1}
\end{figure}

The problem with this approach is that the $f$-values from a parent to each of
its successors may not be monotonically increasing.  The monotone condition is
necessary to guarantee that an optimal solution, if one exists, is always found.
For instance: Theta* can generate $n_2$ from the intermediate point $p = (3,3)$.
The $f$-value of $p$ is taken with respect to the straight-line distance from
$n_1$ and equals 4.16. The $f$-value of $n_2$ is also taken with respect to
$n_1$ but equals 4.12.  $p$ should be expanded after $n_2$ but the opposite
occurs.  In order to avoid this mistake we would need to consider, in addition
to the set of intermediate nodes, all the $y_i$ nodes shown in the figure.
However, the number of candidate $y_i$ nodes is apriori very large: along each
$[0, 1]$ interval represented by a grid edge we may need to consider each point
at location $0 \leq \frac{w}{h} \leq 1$; here $w$ (resp. $h$) is an integer in
$\{0,\dots,W\}$ (resp.  $\{0,\dots,H\}$).  We therefore propose to consider all
the potential $y$ nodes together.

From $n_1$, all the nodes that can be reached with a one step North 
(and potentially any fraction of West/East steps) will be considered.  
We call ``interval'' this set of nodes that are considered together.  

How should we then compute the successors of an interval?  
Look at Figure~\ref{fig::succ1} (left) 
where a North step is taken from the interval $[(1,3)-(4,3)]$
reached from node $(1,1)$.  
The (single) successor of the interval 
is simply computed by projecting the visibility cone 
(represented with dashed lines)
from $(1,1)$ to the next row.  
This leads to the interval $[(1,4)-(5+\frac{1}{2},4)]$.  
Obverse that, as a consequence, the parent of the interval 
(here $(1,1)$) must be kept together with the interval.  

\begin{figure}[ht]
  \begin{minipage}{0.5\linewidth}
  \begin{center}
    \input{tikz/ex2}
  \end{center}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
  \begin{center}
    \input{tikz/ex3}
  \end{center}
  \end{minipage}
  \caption{Computing the successors of an interval}
  \label{fig::succ1}
\end{figure}

There are more complicated situations, 
as presented in Figure~\ref{fig::succ1} (right).  
Here, we can see that an obstacle splits the interval 
in two separate intervals.  
We could define disjunct intervals, 
but it seems more natural to consider them independently.  

Furthermore, the path might turn at node $(3,3)$
(e.g., to reach node $(3,4)$
which is not directly accessible from $(1,1)$).  
The corner $(3,3)$ is therefore a successor of node $(1,1)$ 
and intervals should be built from this node.  

%Let us present more precisely how the successors are splitted.  
%From the interval $I = [(1,3)-(4,3)]$, 
%we assume that an epsilon step 
%(i.e., an infinitely small step North) is taken.  
%This step reveals how the interval will be splitted.  
%Therefore, we generate interval 
%$[(1,3+\varepsilon)-(4+\frac{3}{2}\varepsilon,3+\varepsilon)]$; 
%we then remove the parts that belong to the obstacle, 
%which produces the two intervals 
%$[(1,3+\varepsilon)-(2,3+\varepsilon)]$ 
%$[(3,3+\varepsilon)-(4+\frac{3}{2}\varepsilon,3+\varepsilon)]$; 
%finally, we split the part that is not visible from $(1,1)$, 
%which leads to three intervals: 
%$[(1,3+\varepsilon)-(2,3+\varepsilon)]$, 
%$[(3,3+\varepsilon)-(3+\varepsilon,3+\varepsilon)]$, 
%and
%$](3+\varepsilon,3+\varepsilon)-
%(4+\frac{3}{2}\varepsilon,3+\varepsilon)]$. 
%If we project back on row 3, 
%we obtain three intervals: 
%$[(1,3)-(2,3)]$, 
%$[(3,3)-(3,3)]$, 
%and
%$](3,3)-(4,3)]$. 
%We say that these intervals are ``consistent''%
%\footnote{We need a better word here.} 
%with the obstacles.  
%The first and last intervals can be delt with similarly 
%to the example in Figure~\ref{fig::succ1} (left).  
%The second interval, being a single point, 
%requires to generate new intervals.  

The remaining question is what $f$ value 
should be associated with these intervals.  
For $A^*$ to return the optimal solution, 
we need $f$ to be an underestimate of the actual value 
(except for the final node).  
The interval has the following semantics: 
the path that is currently being constructed 
should start from $s$, cross the parent $P$, 
then cross the interval, and finally reached the goal.  
The shortest path that belongs to this set 
has length $g^*(P) + min_{x \in I}(d(P,x) + h^*(x))$.  
The value $g^*(P)$ should be known at this stage 
(this is one advantage of $A^*$).  
However, the minimum factor is unknown, 
but it can be lower-bounded by $min_{x \in I}(d(P,x) + h(x))$.  
This formula is actually pretty simple to solve, as we now demonstrate.  

Let $z_1$ and $z_2$ be the two extreme points of the interval.  
Draw a direct line between the goal and the parent $P$ of the interval, 
as shown in Figure~\ref{fig::fvalue}.  
If the line crosses the interval in \textit{\u z}, then the value is h(P).  If the line passes on the left, 
then the value is $d(P,z_1)+h(z_1)$; 
otherwise, it is $d(P,z_2)+h(z_2)$.  
If the goal is between the parent and the interval, 
as is the case with $g_4$, 
then one needs to consider the mirrored version of $g_4$ 
(here $g'_4$).  

\begin{figure}[ht]
  \begin{center}
%    \includegraphics[scale=0.3]{images/fvalue}
    \input{tikz/fvalue}
  \end{center}
  \caption{Computing the minimum distance 
    to go from $p$ through the interval to the goal; 
    if the goal is $g_1$, the direct distance between $p$ and $g_1$; 
    if the goal is $g_2$ or $g_3$, 
    the shortest distance is the distance represented by the dashed lines.}
  \label{fig::fvalue}
\end{figure}
